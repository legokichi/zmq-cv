cmake_minimum_required(VERSION 3.1.1)
include(ExternalProject)
PROJECT(External)

set(EXTERNAL_INSTALL_DIR ${CMAKE_BINARY_DIR}/install)

ExternalProject_Add(OpenCV
GIT_REPOSITORY https://github.com/opencv/opencv.git
GIT_TAG 3.4.0
DOWNLOAD_DIR ${CMAKE_SOURCE_DIR}/opencv
PREFIX ${CMAKE_BINARY_DIR}/OpenCV
CMAKE_ARGS
  -DCMAKE_BUILD_TYPE:STRING=RELEASE
  -DBUILD_DOCS:BOOL=OFF
  -DBUILD_EXAMPLES:BOOL=OFF
  -DBUILD_TESTS:BOOL=OFF
  -DBUILD_PERF_TESTS:BOOL=OFF
  -DBUILD_WITH_DEBUG_INFO:BOOL=OFF
  -DCMAKE_INSTALL_PREFIX:PATH=<INSTALL_DIR>
  -DCMAKE_CXX_FLAGS:STRING=${CMAKE_CXX_FLAGS}
  -DCMAKE_MODULE_PATH=${CMAKE_MODULE_PATH}
  -DBUILD_SHARED_LIBS:BOOL=${BUILD_SHARED_LIBS}
  -DBUILD_WITH_STATIC_CRT:BOOL=${BUILD_WITH_STATIC_CRT}
  -DBUILD_OPENCV_WORLD:BOOL=OFF
  -DBUILD_OPENCV_DNN:BOOL=OFF
  -DBUILD_OPENCV_NONFREE:BOOL=ON
  -DBUILD_OPENCV_JAVA:BOOL=OFF
  -DBUILD_OPENCV_PYTHON:BOOL=OFF
  -DBUILD_OPENCV_PYTHON2:BOOL=OFF
  -DBUILD_OPENCV_PYTHON3:BOOL=OFF
  -DBUILD_NEW_PYTHON_SUPPORT=OFF
  -DBUILD_ZLIB:BOOL=OFF
  -DWITH_FFMPEG:BOOL=OFF
  -DWITH_GSTREAMER=ON
  -DWITH_OPENEXR:BOOL=OFF
  -DZLIB_ROOT:PATH=${ZLIB_ROOT}
  -DWITH_GTK_2_X:BOOL=OFF      
  -DWITH_V4L=OFF
  -DWITH_OPENGL=ON
  -DWITH_OPENCL=ON
  -DWITH_CUDA=OFF
  -DWITH_CUBLAS=OFF
  -DWITH_NVCUVID=OFF
  -DWITH_CUFFT=OFF
  -DCUDA_FAST_MATH=ON
  -DWITH_EIGEN=ON
  -DWITH_TBB=ON
  -DWITH_PTHREADS_PF=ON
  -DWITH_IPP=ON
  -DENABLE_PRECOMPILED_HEADERS=ON
  -DENABLE_FAST_MATH=ON
)
